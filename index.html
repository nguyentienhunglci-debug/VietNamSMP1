<!DOCTYPE html>
<html lang="vi">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
Â  Â  <title>Trá»£ LÃ½ CÃ¡ NhÃ¢n</title>
Â  Â Â 
Â  Â  <meta name="apple-mobile-web-app-capable" content="yes">
Â  Â  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
Â  Â  <link rel="manifest" href="manifest.webmanifest">
Â  Â  <link rel="apple-touch-icon" href="icon-192x192.png">

Â  Â  <style>
Â  Â  Â  Â  /* =================================================================
Â  Â  Â  Â  Â  Â 1. DESIGN SYSTEM & VARIABLES
Â  Â  Â  Â  Â  Â ================================================================= */
Â  Â  Â  Â  :root {
Â  Â  Â  Â  Â  Â  --bg-primary: #111111;
Â  Â  Â  Â  Â  Â  --bg-secondary: #1c1c1e;
Â  Â  Â  Â  Â  Â  --card-bg: #1c1c1e;
Â  Â  Â  Â  Â  Â  --text-primary: #f5f5f7;
Â  Â  Â  Â  Â  Â  --text-secondary: #8e8e93;
Â  Â  Â  Â  Â  Â  --accent-primary: #0a84ff;
Â  Â  Â  Â  Â  Â  --accent-red: #ff453a;
Â  Â  Â  Â  Â  Â  --accent-green: #30d158;
Â  Â  Â  Â  Â  Â  --accent-orange: #ff9f0a;
Â  Â  Â  Â  Â  Â  --border-color: #38383a;
Â  Â  Â  Â  Â  Â  --shadow: none;
Â  Â  Â  Â  Â  Â  --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
Â  Â  Â  Â  }

Â  Â  Â  Â  html.light-theme {
Â  Â  Â  Â  Â  Â  --bg-primary: #f2f2f7;
Â  Â  Â  Â  Â  Â  --bg-secondary: #ffffff;
Â  Â  Â  Â  Â  Â  --card-bg: #ffffff;
Â  Â  Â  Â  Â  Â  --text-primary: #000000;
Â  Â  Â  Â  Â  Â  --text-secondary: #636366;
Â  Â  Â  Â  Â  Â  --accent-primary: #007aff;
Â  Â  Â  Â  Â  Â  --border-color: #e5e5ea;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* =================================================================
Â  Â  Â  Â  Â  Â 2. GLOBAL RESETS & BASE STYLES
Â  Â  Â  Â  Â  Â ================================================================= */
Â  Â  Â  Â  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  html {Â 
Â  Â  Â  Â  Â  Â  color-scheme: dark;Â 
Â  Â  Â  Â  Â  Â  scroll-behavior: smooth;
Â  Â  Â  Â  }
Â  Â  Â  Â  html.light-theme { color-scheme: light; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: var(--font-family);
Â  Â  Â  Â  Â  Â  background-color: var(--bg-primary);
Â  Â  Â  Â  Â  Â  color: var(--text-primary);
Â  Â  Â  Â  Â  Â  padding-bottom: 90px;
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s ease, color 0.3s ease;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* =================================================================
Â  Â  Â  Â  Â  Â 3. CORE LAYOUT & COMPONENTS
Â  Â  Â  Â  Â  Â ================================================================= */
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Screens & Navigation --- */
Â  Â  Â  Â  .screen { display: none; padding: 70px 16px 20px 16px; animation: fadeIn 0.4s ease; }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
Â  Â  Â  Â  .screen.active { display: block; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .screen-title-bar {Â 
Â  Â  Â  Â  Â  Â  display: flex;Â 
Â  Â  Â  Â  Â  Â  justify-content: space-between;Â 
Â  Â  Â  Â  Â  Â  align-items: center;Â 
Â  Â  Â  Â  Â  Â  margin-bottom: 24px;Â 
Â  Â  Â  Â  Â  Â  padding: 0 4px;
Â  Â  Â  Â  }
Â  Â  Â  Â  .screen-title-bar h2 {Â 
Â  Â  Â  Â  Â  Â  font-size: 32px;Â 
Â  Â  Â  Â  Â  Â  font-weight: 700;
Â  Â  Â  Â  Â  Â  color: var(--text-primary);
Â  Â  Â  Â  }

Â  Â  Â  Â  .bottom-nav {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  bottom: 0; left: 0; right: 0;
Â  Â  Â  Â  Â  Â  background-color: rgba(var(--card-bg-rgb, 28, 28, 30), 0.85);
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
Â  Â  Â  Â  Â  Â  border-top: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  padding-bottom: env(safe-area-inset-bottom);
Â  Â  Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s, border-color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item {
Â  Â  Â  Â  Â  Â  flex: 1;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  padding: 12px 0 8px 0;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  color: var(--text-secondary);
Â  Â  Â  Â  Â  Â  transition: color 0.2s ease, transform 0.2s ease;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item .nav-icon {
Â  Â  Â  Â  Â  Â  width: 24px;
Â  Â  Â  Â  Â  Â  height: 24px;
Â  Â  Â  Â  Â  Â  margin: 0 auto 4px auto;
Â  Â  Â  Â  Â  Â  stroke-width: 2;
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item .nav-label {Â 
Â  Â  Â  Â  Â  Â  font-size: 10px;Â 
Â  Â  Â  Â  Â  Â  font-weight: 500;Â 
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item.active {
Â  Â  Â  Â  Â  Â  color: var(--accent-primary);
Â  Â  Â  Â  }
Â  Â  Â  Â  .nav-item:active {
Â  Â  Â  Â  Â  Â  transform: scale(0.95);
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- Buttons --- */
Â  Â  Â  Â  .btn {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  Â  Â  padding: 12px 20px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  margin-top: 16px;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s, opacity 0.2s;
Â  Â  Â  Â  Â  Â  background-color: var(--accent-primary);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn .icon { width: 18px; height: 18px; stroke-width: 2.5; }
Â  Â  Â  Â  .btn:active { opacity: 0.7; }

Â  Â  Â  Â  .btn-sec {Â 
Â  Â  Â  Â  Â  Â  background-color: var(--bg-secondary);Â 
Â  Â  Â  Â  Â  Â  color: var(--text-primary);
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  }
Â  Â  Â  Â  .btn-danger { background-color: var(--accent-red); }
Â  Â  Â  Â  .btn-small { padding: 8px 14px; font-size: 14px; }

Â  Â  Â  Â  /* --- Cards & Data Display --- */
Â  Â  Â  Â  .card {
Â  Â  Â  Â  Â  Â  background-color: var(--card-bg);
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  margin-bottom: 16px;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  transition: background-color 0.3s, border-color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .card h3 {
Â  Â  Â  Â  Â  Â  font-size: 18px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  margin-bottom: 16px;
Â  Â  Â  Â  }

Â  Â  Â  Â  .data-card {
Â  Â  Â  Â  Â  Â  background-color: var(--card-bg);
Â  Â  Â  Â  Â  Â  border-radius: 12px;
Â  Â  Â  Â  Â  Â  padding: 16px;
Â  Â  Â  Â  Â  Â  margin-bottom: 12px;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .data-card:active { background-color: var(--bg-primary); }

Â  Â  Â  Â  .data-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px; }
Â  Â  Â  Â  .data-title { font-size: 17px; font-weight: 600; color: var(--text-primary); }
Â  Â  Â  Â  .data-subtitle { font-size: 13px; color: var(--text-secondary); }
Â  Â  Â  Â  .data-content { font-size: 15px; color: var(--text-secondary); line-height: 1.5; margin-top: 8px; white-space: pre-wrap; word-wrap: break-word; }
Â  Â  Â  Â  .data-actions { display: flex; gap: 10px; justify-content: flex-end; margin-top: 16px; padding-top: 16px; border-top: 1px solid var(--border-color); }
Â  Â  Â  Â  .data-btn {
Â  Â  Â  Â  Â  Â  background-color: var(--bg-secondary);
Â  Â  Â  Â  Â  Â  color: var(--text-primary);
Â  Â  Â  Â  Â  Â  padding: 8px 16px;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background-color 0.2s, opacity 0.2s;
Â  Â  Â  Â  }
Â  Â  Â  Â  .data-btn.delete { color: var(--accent-red); }
Â  Â  Â  Â  .data-btn:active { opacity: 0.7; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Forms & Modals --- */
Â  Â  Â  Â  .modal {
Â  Â  Â  Â  Â  Â  display: none; align-items: center; justify-content: center;
Â  Â  Â  Â  Â  Â  position: fixed; inset: 0;
Â  Â  Â  Â  Â  Â  background-color: rgba(0,0,0,0.6);
Â  Â  Â  Â  Â  Â  z-index: 2000;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transition: opacity 0.3s ease;
Â  Â  Â  Â  Â  Â  backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal.show { display: flex; opacity: 1; }
Â  Â  Â  Â  .modal-content {
Â  Â  Â  Â  Â  Â  background-color: var(--bg-secondary);
Â  Â  Â  Â  Â  Â  border-radius: 18px;
Â  Â  Â  Â  Â  Â  padding: 24px;
Â  Â  Â  Â  Â  Â  width: 92%;
Â  Â  Â  Â  Â  Â  max-width: 440px;
Â  Â  Â  Â  Â  Â  max-height: 85vh;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  transform: scale(0.95);
Â  Â  Â  Â  Â  Â  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
Â  Â  Â  Â  }
Â  Â  Â  Â  .modal.show .modal-content { transform: scale(1); }
Â  Â  Â  Â  .modal-title { font-size: 22px; font-weight: 600; margin-bottom: 24px; }
Â  Â  Â  Â  .modal-actions { display: flex; gap: 12px; margin-top: 24px; }

Â  Â  Â  Â  .form-group { margin-bottom: 16px; }
Â  Â  Â  Â  .form-label { display: block; color: var(--text-secondary); font-size: 14px; margin-bottom: 8px; font-weight: 500; }
Â  Â  Â  Â  .form-input, .form-select, .form-textarea {
Â  Â  Â  Â  Â  Â  background-color: var(--bg-primary);
Â  Â  Â  Â  Â  Â  color: var(--text-primary);
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 14px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  transition: border-color 0.2s, background-color 0.2s;
Â  Â  Â  Â  Â  Â  -webkit-appearance: none;
Â  Â  Â  Â  }
Â  Â  Â  Â  .form-input:focus, .form-select:focus, .form-textarea:focus {
Â  Â  Â  Â  Â  Â  outline: none;
Â  Â  Â  Â  Â  Â  border-color: var(--accent-primary);
Â  Â  Â  Â  }
Â  Â  Â  Â  .form-textarea { min-height: 120px; }

Â  Â  Â  Â  /* --- Toasts & Overlays --- */
Â  Â  Â  Â  .copy-toast {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  bottom: 100px; left: 50%;
Â  Â  Â  Â  Â  Â  transform: translateX(-50%);
Â  Â  Â  Â  Â  Â  background-color: #2c2c2e;
Â  Â  Â  Â  Â  Â  color: #f5f5f7;
Â  Â  Â  Â  Â  Â  padding: 12px 24px;
Â  Â  Â  Â  Â  Â  border-radius: 25px;
Â  Â  Â  Â  Â  Â  z-index: 3000;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transition: opacity 0.3s, transform 0.3s;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 20px rgba(0,0,0,0.3);
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  }
Â  Â  Â  Â  .copy-toast.show { opacity: 1; transform: translate(-50%, -10px); }

Â  Â  Â  Â  /* =================================================================
Â  Â  Â  Â  Â  Â 4. SCREEN-SPECIFIC STYLES
Â  Â  Â  Â  Â  Â ================================================================= */
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Schedule Screen --- */
Â  Â  Â  Â  #schedule-container { text-align: center; padding-top: 10px; }
Â  Â  Â  Â  #clock-time { font-size: 56px; font-weight: 600; letter-spacing: 1px; }
Â  Â  Â  Â  #clock-date { font-size: 17px; color: var(--text-secondary); margin-top: -5px; margin-bottom: 30px; }
Â  Â  Â  Â  .schedule-section h3 { font-size: 20px; font-weight: 600; text-align: left; margin-bottom: 16px; padding-left: 4px; }
Â  Â  Â  Â  .schedule-item {
Â  Â  Â  Â  Â  Â  background-color: var(--card-bg);
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  padding: 16px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  Â  Â  font-size: 16px;
Â  Â  Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  Â  Â  border-left: 3px solid var(--accent-green);
Â  Â  Â  Â  Â  Â  text-align: left;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  }
Â  Â  Â  Â  .schedule-item-off { border-left-color: var(--accent-orange); }
Â  Â  Â  Â  .schedule-item span { color: var(--text-secondary); font-size: 14px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Finance Screen --- */
Â  Â  Â  Â  .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
Â  Â  Â  Â  .stat-card { background-color: var(--bg-primary); padding: 16px; border-radius: 10px; text-align: left; border: 1px solid var(--border-color); }
Â  Â  Â  Â  .stat-card.full-width { grid-column: 1 / -1; }
Â  Â  Â  Â  .stat-label { color: var(--text-secondary); font-size: 14px; margin-bottom: 6px; }
Â  Â  Â  Â  .stat-value { font-size: 24px; font-weight: 600; }
Â  Â  Â  Â  .stat-value.red { color: var(--accent-red); }
Â  Â  Â  Â  .stat-value.green { color: var(--accent-green); }
Â  Â  Â  Â  .finance-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }

Â  Â  Â  Â  .txn-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 4px; border-bottom: 1px solid var(--border-color); }
Â  Â  Â  Â  .txn-item:last-child { border-bottom: none; }
Â  Â  Â  Â  .txn-details .data-title { font-size: 16px; }
Â  Â  Â  Â  .txn-details .data-subtitle { font-size: 13px; }
Â  Â  Â  Â  .txn-amount { font-size: 16px; font-weight: 600; }
Â  Â  Â  Â  .txn-amount.red { color: var(--accent-red); }
Â  Â  Â  Â  .txn-amount.green { color: var(--accent-green); }

Â  Â  Â  Â  /* --- Photos Screen --- */
Â  Â  Â  Â  #photosGrid { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 12px; }
Â  Â  Â  Â  .photo-item { position: relative; aspect-ratio: 1 / 1; background-color: var(--card-bg); border-radius: 12px; overflow: hidden; border: 1px solid var(--border-color); }
Â  Â  Â  Â  .photo-item img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }
Â  Â  Â  Â  .photo-item:active img { transform: scale(1.05); }
Â  Â  Â  Â  .photo-item .delete-photo-btn { position: absolute; top: 8px; right: 8px; width: 28px; height: 28px; background: rgba(0,0,0,0.5); color: white; border: none; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 16px; opacity: 0; transition: opacity 0.2s; backdrop-filter: blur(5px); }
Â  Â  Â  Â  .photo-item:hover .delete-photo-btn { opacity: 1; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Passwords Screen --- */
Â  Â  Â  Â  .password-field-container { margin-top: 12px; }
Â  Â  Â  Â  .password-label { font-size: 13px; margin-bottom: 6px; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.5px; }
Â  Â  Â  Â  .password-value-container { background-color: var(--bg-primary); padding: 12px; border-radius: 8px; border: 1px solid var(--border-color); font-size: 16px; letter-spacing: 1px; font-family: monospace; color: var(--text-primary); margin-bottom: 12px; }
Â  Â  Â  Â  .password-actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
Â  Â  Â  Â  .password-btn { background-color: var(--bg-secondary); color: var(--text-primary); border: 1px solid var(--border-color); padding: 10px; border-radius: 8px; font-size: 15px; font-weight: 500; cursor: pointer; transition: background-color 0.2s; }
Â  Â  Â  Â  .password-btn:active { background-color: var(--bg-primary); }

Â  Â  Â  Â  /* --- Settings Screen --- */
Â  Â  Â  Â  .setting-item { display: flex; justify-content: space-between; align-items: center; padding: 16px 4px; border-bottom: 1px solid var(--border-color); }
Â  Â  Â  Â  .setting-item:last-child { border-bottom: none; }
Â  Â  Â  Â  .setting-item span { font-size: 16px; font-weight: 500; }
Â  Â  Â  Â  .toggle-switch { width: 50px; height: 30px; background-color: var(--bg-primary); border-radius: 15px; position: relative; transition: background-color 0.3s; border: 1px solid var(--border-color); }
Â  Â  Â  Â  .toggle-knob { width: 24px; height: 24px; background-color: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); box-shadow: 0 1px 3px rgba(0,0,0,0.2); }
Â  Â  Â  Â  html.light-theme .toggle-knob { background-color: #f2f2f7; border: 1px solid #ddd; }
Â  Â  Â  Â  .toggle-switch.active { background-color: var(--accent-green); border-color: var(--accent-green); }
Â  Â  Â  Â  .toggle-switch.active .toggle-knob { transform: translateX(20px); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Passcode Screen --- */
Â  Â  Â  Â  .screen-overlay { display: none; position: fixed; inset: 0; background: var(--bg-primary); z-index: 5000; align-items: center; justify-content: center; flex-direction: column; text-align: center; }
Â  Â  Â  Â  .screen-overlay.show { display: flex; }
Â  Â  Â  Â  .passcode-container { max-width: 300px; }
Â  Â  Â  Â  #passcode-title { font-size: 22px; font-weight: 600; margin-bottom: 24px; }
Â  Â  Â  Â  .passcode-dots-container { display: flex; justify-content: center; gap: 20px; margin-bottom: 24px; }
Â  Â  Â  Â  .passcode-dot { width: 14px; height: 14px; border-radius: 50%; background-color: var(--bg-secondary); border: 1px solid var(--border-color); transition: background-color 0.2s; }
Â  Â  Â  Â  .passcode-dot.filled { background-color: var(--accent-primary); border-color: var(--accent-primary); }
Â  Â  Â  Â  .passcode-keypad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 24px; }
Â  Â  Â  Â  .keypad-btn { width: 75px; height: 75px; border-radius: 50%; border: none; background-color: var(--bg-secondary); color: var(--text-primary); font-size: 32px; font-weight: 400; cursor: pointer; transition: background-color 0.2s; }
Â  Â  Â  Â  .keypad-btn:active { background-color: #333; }
Â  Â  Â  Â  html.light-theme .keypad-btn { background-color: #fff; }
Â  Â  Â  Â  html.light-theme .keypad-btn:active { background-color: #eee; }
Â  Â  Â  Â  .keypad-btn.action { font-size: 24px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- Music Player --- */
Â  Â  Â  Â  #music-player-bubble {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  bottom: calc(85px + 15px);
Â  Â  Â  Â  Â  Â  right: 15px;
Â  Â  Â  Â  Â  Â  width: 60px;
Â  Â  Â  Â  Â  Â  height: 60px;
Â  Â  Â  Â  Â  Â  background-color: var(--card-bg);
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  border: 1px solid var(--border-color);
Â  Â  Â  Â  Â  Â  box-shadow: 0 5px 15px rgba(0,0,0,0.2);
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
Â  Â  Â  Â  Â  Â  z-index: 999;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  }
Â  Â  Â  Â  #music-player-bubble.expanded {
Â  Â  Â  Â  Â  Â  width: 90vw;
Â  Â  Â  Â  Â  Â  max-width: 380px;
Â  Â  Â  Â  Â  Â  height: auto;
Â  Â  Â  Â  Â  Â  border-radius: 16px;
Â  Â  Â  Â  Â  Â  padding: 12px;
Â  Â  Â  Â  Â  Â  cursor: default;
Â  Â  Â  Â  }
Â  Â  Â  Â  #music-player-bubble .player-controls {
Â  Â  Â  Â  Â  Â  display: none; align-items: center; justify-content: space-between; width: 100%;
Â  Â  Â  Â  }
Â  Â  Â  Â  #music-player-bubble.expanded .player-controls { display: flex; }
Â  Â  Â  Â  #music-player-bubble .player-controls .title { font-weight: 600; font-size: 15px; }
Â  Â  Â  Â  #music-player-bubble .player-controls button {
Â  Â  Â  Â  Â  Â  background: none; border: none; color: var(--text-secondary); font-size: 24px; cursor: pointer; padding: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â  #music-player-bubble iframe { display: none; width: 100%; height: 180px; border: none; border-radius: 10px; margin-top: 12px; }
Â  Â  Â  Â  #music-player-bubble.expanded iframe { display: block; }
Â  Â  Â  Â  #music-player-bubble .bubble-icon { font-size: 24px; display: block; }
Â  Â  Â  Â  #music-player-bubble.expanded .bubble-icon { display: none; }

Â  Â  </style>
</head>
<body>

<div class="main-container">
Â  Â  <div id="schedule" class="screen active">
Â  Â  Â  Â  <div class="screen-title-bar">
Â  Â  Â  Â  Â  Â  <h2>Lá»‹ch trÃ¬nh</h2>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="schedule-container">
Â  Â  Â  Â  Â  Â  <div id="clock-time">--:--:--</div>
Â  Â  Â  Â  Â  Â  <div id="clock-date">---, --/--/----</div>
Â  Â  Â  Â  Â  Â  <div id="today-schedule" class="schedule-section"></div>
Â  Â  Â  Â  Â  Â  <div id="future-schedule" class="schedule-section"></div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="finance" class="screen">
Â  Â  Â  Â  <div class="screen-title-bar">
Â  Â  Â  Â  Â  Â  <h2>TÃ i chÃ­nh</h2>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <div class="stat-grid">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card full-width">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-label">Tá»•ng sá»‘ dÆ°</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-value" id="bal">0â‚«</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-label">ÄÃ£ chi</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-value red" id="exp">0â‚«</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-label">Thu nháº­p</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-value green" id="inc">0â‚«</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="finance-actions">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-danger" style="margin: 0;" onclick="openTxn('expense')">Chi tiÃªu</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn" style="margin: 0; background-color: var(--accent-green);" onclick="openTxn('income')">Thu nháº­p</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <h3>Lá»‹ch sá»­ giao dá»‹ch</h3>
Â  Â  Â  Â  Â  Â  <input type="text" class="form-input" placeholder="TÃ¬m kiáº¿m giao dá»‹ch..." id="search" oninput="renderHistory()" style="margin-bottom: 15px;">
Â  Â  Â  Â  Â  Â  <div id="histList"></div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="notes" class="screen">
Â  Â  Â  Â  <div class="screen-title-bar">
Â  Â  Â  Â  Â  Â  <h2>Ghi chÃº</h2>
Â  Â  Â  Â  Â  Â  <button class="btn btn-small" onclick="openNote()">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg>
Â  Â  Â  Â  Â  Â  Â  Â  <span>Ghi chÃº má»›i</span>
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="notesList"></div>
Â  Â  </div>

Â  Â  <div id="photos" class="screen">
Â  Â  Â  Â  <div class="screen-title-bar">
Â  Â  Â  Â  Â  Â  <h2>áº¢nh</h2>
Â  Â  Â  Â  Â  Â  <button class="btn btn-small" onclick="openPhotoModal()">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg>
Â  Â  Â  Â  Â  Â  Â  Â  <span>ThÃªm áº£nh</span>
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="photosGrid"></div>
Â  Â  </div>

Â  Â  <div id="passwords" class="screen">
Â  Â  Â  Â  <div class="screen-title-bar">
Â  Â  Â  Â  Â  Â  <h2>Máº­t kháº©u</h2>
Â  Â  Â  Â  Â  Â  <button class="btn btn-small" onclick="openPasswordModal()">
Â  Â  Â  Â  Â  Â  Â  Â  <svg class="icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4"></path></svg>
Â  Â  Â  Â  Â  Â  Â  Â  <span>ThÃªm má»›i</span>
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div id="passwordsList"></div>
Â  Â  </div>

Â  Â  <div id="settings" class="screen">
Â  Â  Â  Â  <div class="screen-title-bar">
Â  Â  Â  Â  Â  Â  <h2>CÃ i Ä‘áº·t</h2>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <h3>Giao diá»‡n & Báº£o máº­t</h3>
Â  Â  Â  Â  Â  Â  <div class="setting-item">
Â  Â  Â  Â  Â  Â  Â  Â  <span>Cháº¿ Ä‘á»™ sÃ¡ng</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="toggle-switch" id="theme-toggle" onclick="toggleTheme()"><div class="toggle-knob"></div></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="setting-item">
Â  Â  Â  Â  Â  Â  Â  Â  <span>KhÃ³a á»©ng dá»¥ng</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="toggle-switch" id="password-protection-toggle" onclick="togglePasswordProtection()"><div class="toggle-knob"></div></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="card">
Â  Â  Â  Â  Â  Â  <h3>Quáº£n lÃ½ dá»¯ liá»‡u</h3>
Â  Â  Â  Â  Â  Â  <button class="btn btn-danger" onclick="resetData()">XÃ³a toÃ n bá»™ dá»¯ liá»‡u</button>
Â  Â  Â  Â  Â  Â  <button class="btn btn-sec" onclick="reloadApp()">Táº£i láº¡i á»©ng dá»¥ng</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div class="bottom-nav">
Â  Â  Â  Â  <div class="nav-item active" onclick="goTo('schedule', this)">
Â  Â  Â  Â  Â  Â  <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
Â  Â  Â  Â  Â  Â  <div class="nav-label">Lá»‹ch trÃ¬nh</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item" onclick="goTo('finance', this)">
Â  Â  Â  Â  Â  Â  <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
Â  Â  Â  Â  Â  Â  <div class="nav-label">TÃ i chÃ­nh</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item" onclick="goTo('notes', this)">
Â  Â  Â  Â  Â  Â  <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
Â  Â  Â  Â  Â  Â  <div class="nav-label">Ghi chÃº</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item" onclick="goTo('photos', this)">
Â  Â  Â  Â  Â  Â  <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
Â  Â  Â  Â  Â  Â  <div class="nav-label">áº¢nh</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item" onclick="goTo('passwords', this)">
Â  Â  Â  Â  Â  Â  <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.629 5.629l-2.371 2.371a2.121 2.121 0 01-3 0l-1.371-1.371a2.121 2.121 0 010-3l2.371-2.371A6 6 0 0121 9z"></path></svg>
Â  Â  Â  Â  Â  Â  <div class="nav-label">Máº­t kháº©u</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item" onclick="goTo('settings', this)">
Â  Â  Â  Â  Â  Â  <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
Â  Â  Â  Â  Â  Â  <div class="nav-label">CÃ i Ä‘áº·t</div>
Â  Â  Â  Â  </div>
Â  Â  </div>
</div>

<div id="txnModal" class="modal"><div class="modal-content"><h2 class="modal-title" id="modalTitle"></h2><div class="form-group"><label class="form-label">Sá»‘ tiá»n (â‚«)</label><input type="text" class="form-input" id="amt" placeholder="50000" inputmode="numeric"></div><div class="form-group"><label class="form-label">Danh má»¥c</label><select class="form-select" id="cat"><option value="Ä‚n uá»‘ng">Ä‚n uá»‘ng</option><option value="Äi láº¡i">Äi láº¡i</option><option value="Mua sáº¯m">Mua sáº¯m</option><option value="HÃ³a Ä‘Æ¡n">HÃ³a Ä‘Æ¡n</option><option value="LÆ°Æ¡ng">LÆ°Æ¡ng</option><option value="Giáº£i trÃ­">Giáº£i trÃ­</option><option value="KhÃ¡c">KhÃ¡c</option></select></div><div class="form-group"><label class="form-label">Ghi chÃº (khÃ´ng báº¯t buá»™c)</label><textarea class="form-textarea" id="note" placeholder="VD: CÃ  phÃª vá»›i báº¡n bÃ¨..."></textarea></div><input type="hidden" id="type"><input type="hidden" id="editId"><div class="modal-actions"><button class="btn btn-sec" onclick="closeModal('txnModal')" style="flex:1; margin:0;">Há»§y</button><button class="btn" id="saveTxnBtn" onclick="saveTxn()" style="flex:1; margin:0;">LÆ°u</button></div></div></div>
<div id="noteModal" class="modal"><div class="modal-content"><h2 class="modal-title" id="noteModalTitle">Táº¡o ghi chÃº</h2><div class="form-group"><label class="form-label">TiÃªu Ä‘á»</label><input type="text" class="form-input" id="noteTitle" placeholder="TiÃªu Ä‘á» ghi chÃº"></div><div class="form-group"><label class="form-label">Ná»™i dung</label><textarea class="form-textarea" id="noteContent" placeholder="Viáº¿t ná»™i dung cá»§a báº¡n á»Ÿ Ä‘Ã¢y..."></textarea></div><input type="hidden" id="editNoteId"><div class="modal-actions"><button class="btn btn-sec" onclick="closeModal('noteModal')" style="flex:1; margin:0;">Há»§y</button><button class="btn" onclick="saveNote()" style="flex:1; margin:0;">LÆ°u</button></div></div></div>
<div id="passwordModal" class="modal"><div class="modal-content"><h2 class="modal-title" id="passwordModalTitle">ThÃªm máº­t kháº©u</h2><div class="form-group"><label class="form-label">TÃªn dá»‹ch vá»¥</label><input type="text" class="form-input" id="passwordService" placeholder="VD: Zalo, Facebook..."></div><div class="form-group"><label class="form-label">TÃªn Ä‘Äƒng nháº­p / Email</label><input type="text" class="form-input" id="passwordUsername" placeholder="VD: example@email.com"></div><div class="form-group"><label class="form-label">Máº­t kháº©u</label><input type="password" class="form-input" id="passwordValue" placeholder="Nháº­p máº­t kháº©u cá»§a báº¡n"></div><input type="hidden" id="editPasswordId"><div class="modal-actions"><button class="btn btn-sec" onclick="closeModal('passwordModal')" style="flex:1; margin:0;">Há»§y</button><button class="btn" onclick="savePassword()" style="flex:1; margin:0;">LÆ°u</button></div></div></div>
<div id="photoModal" class="modal"><div class="modal-content"><h2 class="modal-title">LÆ°u áº£nh má»›i</h2><div class="form-group"><label class="form-label">TiÃªu Ä‘á» (khÃ´ng báº¯t buá»™c)</label><input type="text" class="form-input" id="photoTitle" placeholder="VD: áº¢nh CCCD"></div><div class="form-group"><label class="form-label">Chá»n áº£nh</label><input type="file" class="form-input" id="photoFile" accept="image/*" onchange="handlePhotoPreview(event)"><img id="photoPreview" src="" alt="Xem trÆ°á»›c áº£nh" style="width: 100%; max-height: 250px; object-fit: contain; border-radius: 8px; margin-top: 10px; display: none;"></div><div class="modal-actions"><button class="btn btn-sec" onclick="closeModal('photoModal')" style="flex:1; margin:0;">Há»§y</button><button class="btn" onclick="savePhoto()" style="flex:1; margin:0;">LÆ°u</button></div></div></div>
<div id="passcode-screen" class="screen-overlay"><div class="passcode-container"><h3 id="passcode-title">Nháº­p máº­t mÃ£</h3><div class="passcode-dots-container" id="passcode-dots"><div class="passcode-dot"></div><div class="passcode-dot"></div><div class="passcode-dot"></div><div class="passcode-dot"></div></div><p id="passcode-error" style="color: var(--accent-red); font-size: 14px; min-height: 20px;"></p><div class="passcode-keypad"><button class="keypad-btn" onclick="passcode.keyPress('1')">1</button><button class="keypad-btn" onclick="passcode.keyPress('2')">2</button><button class="keypad-btn" onclick="passcode.keyPress('3')">3</button><button class="keypad-btn" onclick="passcode.keyPress('4')">4</button><button class="keypad-btn" onclick="passcode.keyPress('5')">5</button><button class="keypad-btn" onclick="passcode.keyPress('6')">6</button><button class="keypad-btn" onclick="passcode.keyPress('7')">7</button><button class="keypad-btn" onclick="passcode.keyPress('8')">8</button><button class="keypad-btn" onclick="passcode.keyPress('9')">9</button><div></div><button class="keypad-btn" onclick="passcode.keyPress('0')">0</button><button class="keypad-btn action" onclick="passcode.backspace()">âŒ«</button></div></div></div>

<div id="music-player-bubble" onclick="musicPlayer.toggleExpand(event)">
Â  Â  <span class="bubble-icon">ğŸµ</span>
Â  Â  <div class="player-controls">
Â  Â  Â  Â  <span class="title">Lofi Radio</span>
Â  Â  Â  Â  <button onclick="musicPlayer.togglePlayPause(event)">â¯</button>
Â  Â  </div>
Â  Â  <iframe id="youtube-player" src="https://www.youtube.com/embed/jfKfPfyJRdk?enablejsapi=1&autoplay=0" allow="autoplay; encrypted-media"></iframe>
</div>

<script type="text/javascript">
'use strict';

// =================================================================
// 1. INITIALIZATION & SETUP
// =================================================================
(function initializeTheme() {
Â  Â  const savedTheme = localStorage.getItem('theme');
Â  Â  const isLight = savedTheme === 'light';
Â  Â  if (isLight) {
Â  Â  Â  Â  document.documentElement.classList.add('light-theme');
Â  Â  }
Â  Â  const themeToggle = document.getElementById('theme-toggle');
Â  Â  if(themeToggle) themeToggle.classList.toggle('active', isLight);
Â  Â Â 
Â  Â  // Set RGB color for transparent backgrounds
Â  Â  const cardBgColor = isLight ? '255, 255, 255' : '28, 28, 30';
Â  Â  document.documentElement.style.setProperty('--card-bg-rgb', cardBgColor);
})();

(function initializePasswordProtection() {
Â  Â  const isEnabled = localStorage.getItem('passwordProtectionEnabled') === 'true';
Â  Â  const toggle = document.getElementById('password-protection-toggle');
Â  Â  if(toggle) toggle.classList.toggle('active', isEnabled);
})();

// YouTube Player API
var tag = document.createElement('script');
tag.src = "https://www.youtube.com/iframe_api";
var firstScriptTag = document.getElementsByTagName('script')[0];
firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

var player;
function onYouTubeIframeAPIReady() {
Â  Â  player = new YT.Player('youtube-player', {
Â  Â  Â  Â  events: { 'onReady': musicPlayer.onPlayerReady }
Â  Â  });
}

// =================================================================
// 2. DATABASE & STATE MANAGEMENT
// =================================================================
const IDB = {
Â  Â  db: null, DB_NAME: 'PersonalAssistantDB_v2', STORE_NAME: 'photos',
Â  Â  async init() {
Â  Â  Â  Â  if (this.db) return;
Â  Â  Â  Â  return new Promise((resolve, reject) => {
Â  Â  Â  Â  Â  Â  const request = indexedDB.open(this.DB_NAME, 1);
Â  Â  Â  Â  Â  Â  request.onerror = e => { console.error("IndexedDB error:", e.target.errorCode); reject("IndexedDB error"); };
Â  Â  Â  Â  Â  Â  request.onsuccess = e => { this.db = e.target.result; resolve(); };
Â  Â  Â  Â  Â  Â  request.onupgradeneeded = e => { if (!e.target.result.objectStoreNames.contains(this.STORE_NAME)) { e.target.result.createObjectStore(this.STORE_NAME, { keyPath: 'id' }); }};
Â  Â  Â  Â  });
Â  Â  },
Â  Â  async add(item) { await this.init(); return new Promise((resolve, reject) => { const tx = this.db.transaction([this.STORE_NAME], 'readwrite'); tx.objectStore(this.STORE_NAME).add(item); tx.oncomplete = () => resolve(); tx.onerror = e => reject(e.target.error); }); },
Â  Â  async getAll() { await this.init(); return new Promise((resolve, reject) => { const req = this.db.transaction([this.STORE_NAME]).objectStore(this.STORE_NAME).getAll(); req.onsuccess = () => resolve(req.result.reverse()); req.onerror = e => reject(e.target.error); }); },
Â  Â  async delete(id) { await this.init(); return new Promise((resolve, reject) => { const tx = this.db.transaction([this.STORE_NAME], 'readwrite'); tx.objectStore(this.STORE_NAME).delete(id); tx.oncomplete = () => resolve(); tx.onerror = e => reject(e.target.error); }); },
Â  Â  async clear() { await this.init(); return new Promise((resolve, reject) => { const tx = this.db.transaction([this.STORE_NAME], 'readwrite'); tx.objectStore(this.STORE_NAME).clear(); tx.oncomplete = () => resolve(); tx.onerror = e => reject(e.target.error); }); }
};

const DB = {
Â  Â  get: (key) => JSON.parse(localStorage.getItem(key) || '[]'),
Â  Â  save: (key, data) => localStorage.setItem(key, JSON.stringify(data)),
};

const scheduleData = [ { dayName: 'Chá»§ Nháº­t', morning: [], afternoon: [] }, { dayName: 'Thá»© Hai', morning: ['ChÃ o cá»', 'ToÃ¡n', 'Váº­t LÃ½'], afternoon: ['Ngá»¯ VÄƒn', 'Tiáº¿ng Anh'] }, { dayName: 'Thá»© Ba', morning: ['HÃ³a Há»c', 'Sinh Há»c', 'Lá»‹ch Sá»­'], afternoon: ['Äá»‹a LÃ½', 'ToÃ¡n'] }, { dayName: 'Thá»© TÆ°', morning: ['Thá»ƒ dá»¥c', 'Ngá»¯ VÄƒn', 'ToÃ¡n'], afternoon: ['Tiáº¿ng Anh', 'GDCD'] }, { dayName: 'Thá»© NÄƒm', morning: ['Váº­t LÃ½', 'HÃ³a Há»c', 'Lá»‹ch Sá»­'], afternoon: ['Ngá»¯ VÄƒn', 'ToÃ¡n'] }, { dayName: 'Thá»© SÃ¡u', morning: ['Sá»­', 'HoÃ¡', 'ToÃ¡n', 'Ã‚m nháº¡c', 'CÃ´ng nghá»‡'], afternoon: [] }, { dayName: 'Thá»© Báº£y', morning: [], afternoon: [] } ];
let lastRenderedDay = -1, clockInterval = null;

// =================================================================
// 3. CORE APP LOGIC & UI
// =================================================================
function goTo(screenId, element) {
Â  Â  if (screenId === 'passwords' && localStorage.getItem('passwordProtectionEnabled') === 'true' && sessionStorage.getItem('isAuthenticated') !== 'true') {
Â  Â  Â  Â  passcode.prompt(() => goTo(screenId, element), () => {});
Â  Â  Â  Â  return;
Â  Â  }
Â  Â  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
Â  Â  document.getElementById(screenId).classList.add('active');
Â  Â  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
Â  Â  element.classList.add('active');
Â  Â  window.scrollTo(0, 0);
}

function updateClockAndSchedule() {
Â  Â  const now = new Date();
Â  Â  const dayIndex = now.getDay();
Â  Â  document.getElementById('clock-time').textContent = now.toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
Â  Â  if (dayIndex !== lastRenderedDay) {
Â  Â  Â  Â  renderFullSchedule(now);
Â  Â  Â  Â  lastRenderedDay = dayIndex;
Â  Â  }
}

function renderFullSchedule(now) {
Â  Â  const dayIndex = now.getDay();
Â  Â  document.getElementById('clock-date').textContent = now.toLocaleDateString('vi-VN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
Â  Â  const todaySchedule = scheduleData[dayIndex];
Â  Â  const todayContainer = document.getElementById('today-schedule');
Â  Â  let todayHTML = '<h3>HÃ´m nay</h3>';
Â  Â  const allTodayClasses = [...todaySchedule.morning, ...todaySchedule.afternoon];
Â  Â  if (allTodayClasses.length === 0) {
Â  Â  Â  Â  todayHTML += `<div class="schedule-item schedule-item-off">HÃ´m nay Ä‘Æ°á»£c nghá»‰</div>`;
Â  Â  } else {
Â  Â  Â  Â  todayHTML += todaySchedule.morning.map(s => `<div class="schedule-item">${s} <span>SÃ¡ng</span></div>`).join('');
Â  Â  Â  Â  todayHTML += todaySchedule.afternoon.map(s => `<div class="schedule-item">${s} <span>Chiá»u</span></div>`).join('');
Â  Â  }
Â  Â  todayContainer.innerHTML = todayHTML;

Â  Â  const futureContainer = document.getElementById('future-schedule');
Â  Â  futureContainer.innerHTML = `<h3>Sáº¯p tá»›i</h3>` +
Â  Â  Â  Â  [1, 2].map(offset => {
Â  Â  Â  Â  Â  Â  const nextDayIndex = (dayIndex + offset) % 7;
Â  Â  Â  Â  Â  Â  const daySchedule = scheduleData[nextDayIndex];
Â  Â  Â  Â  Â  Â  const hasClasses = daySchedule.morning.length + daySchedule.afternoon.length > 0;
Â  Â  Â  Â  Â  Â  return `<div class="schedule-item ${!hasClasses ? 'schedule-item-off' : ''}">${daySchedule.dayName} <span>${hasClasses ? 'Äi há»c' : 'Nghá»‰'}</span></div>`;
Â  Â  Â  Â  }).join('');
}

function toggleTheme() {
Â  Â  const htmlEl = document.documentElement;
Â  Â  htmlEl.classList.toggle('light-theme');
Â  Â  const isLight = htmlEl.classList.contains('light-theme');
Â  Â  localStorage.setItem('theme', isLight ? 'light' : 'dark');
Â  Â  document.getElementById('theme-toggle').classList.toggle('active', isLight);
Â  Â  const cardBgColor = isLight ? '255, 255, 255' : '28, 28, 30';
Â  Â  htmlEl.style.setProperty('--card-bg-rgb', cardBgColor);
}

function openModal(modalId) { document.getElementById(modalId).classList.add('show'); }
function closeModal(modalId) {
Â  Â  const modal = document.getElementById(modalId);
Â  Â  modal.classList.remove('show');
Â  Â  if (modalId === 'photoModal') {
Â  Â  Â  Â  modal.querySelector('#photoFile').value = '';
Â  Â  Â  Â  modal.querySelector('#photoTitle').value = '';
Â  Â  Â  Â  modal.querySelector('#photoPreview').style.display = 'none';
Â  Â  Â  Â  modal.querySelector('#photoPreview').src = '';
Â  Â  }
}

function showToast(message) {
Â  Â  const existingToast = document.querySelector('.copy-toast');
Â  Â  if (existingToast) existingToast.remove();
Â  Â  const toast = document.createElement('div');
Â  Â  toast.textContent = message;
Â  Â  toast.className = 'copy-toast';
Â  Â  document.body.appendChild(toast);
Â  Â  setTimeout(() => toast.classList.add('show'), 10);
Â  Â  setTimeout(() => {
Â  Â  Â  Â  toast.classList.remove('show');
Â  Â  Â  Â  setTimeout(() => toast.remove(), 300);
Â  Â  }, 2000);
}

// =================================================================
// 4. FEATURE MODULES (Finance, Notes, Photos, etc.)
// =================================================================

// --- Finance ---
function renderStats() {
Â  Â  const txns = DB.get('txns');
Â  Â  const totalIncome = txns.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0);
Â  Â  const totalExpense = txns.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0);
Â  Â  const formatCurrency = (val) => new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(val);
Â  Â  document.getElementById('bal').textContent = formatCurrency(totalIncome - totalExpense);
Â  Â  document.getElementById('inc').textContent = formatCurrency(totalIncome);
Â  Â  document.getElementById('exp').textContent = formatCurrency(totalExpense);
}

function renderHistory() {
Â  Â  const container = document.getElementById('histList');
Â  Â  const searchTerm = document.getElementById('search').value.toLowerCase();
Â  Â  const txns = DB.get('txns')
Â  Â  Â  Â  .filter(t => t.note?.toLowerCase().includes(searchTerm) || t.amount.toString().includes(searchTerm))
Â  Â  Â  Â  .sort((a, b) => new Date(b.date) - new Date(a.date));
Â  Â Â 
Â  Â  if (txns.length === 0) {
Â  Â  Â  Â  container.innerHTML = `<p style="text-align:center; color: var(--text-secondary); padding: 20px 0;">KhÃ´ng cÃ³ giao dá»‹ch nÃ o.</p>`;
Â  Â  Â  Â  return;
Â  Â  }
Â  Â  container.innerHTML = txns.map(txn => {
Â  Â  Â  Â  const isExpense = txn.type === 'expense';
Â  Â  Â  Â  const amountSign = isExpense ? '-' : '+';
Â  Â  Â  Â  return `<div class="txn-item">
Â  Â  Â  Â  Â  Â  <div class="txn-details">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="data-title">${txn.category}</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="data-subtitle">${new Date(txn.date).toLocaleString('vi-VN', { day: '2-digit', month: '2-digit', year: 'numeric' })}</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="txn-amount ${isExpense ? 'red' : 'green'}">${amountSign}${new Intl.NumberFormat('vi-VN').format(txn.amount)}â‚«</div>
Â  Â  Â  Â  </div>`;
Â  Â  }).join('');
}

function openTxn(type, id = null) {
Â  Â  const modal = document.getElementById('txnModal');
Â  Â  modal.querySelector('#modalTitle').textContent = type === 'expense' ? 'ThÃªm chi tiÃªu' : 'ThÃªm thu nháº­p';
Â  Â  modal.querySelector('#type').value = type;
Â  Â  modal.querySelector('#amt').value = '';
Â  Â  modal.querySelector('#note').value = '';
Â  Â  modal.querySelector('#editId').value = '';
Â  Â  openModal('txnModal');
}
function saveTxn() {
Â  Â  const amount = parseFloat(document.getElementById('amt').value);
Â  Â  if (!amount || amount <= 0) { alert('Vui lÃ²ng nháº­p sá»‘ tiá»n há»£p lá»‡.'); return; }
Â  Â  const newTxn = {
Â  Â  Â  Â  id: 'txn_' + Date.now(),
Â  Â  Â  Â  date: new Date().toISOString(),
Â  Â  Â  Â  amount,
Â  Â  Â  Â  category: document.getElementById('cat').value,
Â  Â  Â  Â  note: document.getElementById('note').value.trim(),
Â  Â  Â  Â  type: document.getElementById('type').value,
Â  Â  };
Â  Â  const txns = DB.get('txns');
Â  Â  txns.push(newTxn);
Â  Â  DB.save('txns', txns);
Â  Â  closeModal('txnModal');
Â  Â  renderStats();
Â  Â  renderHistory();
}

// --- Notes ---
function renderNotes() {
Â  Â  const container = document.getElementById('notesList');
Â  Â  const notes = DB.get('notes');
Â  Â  if (notes.length === 0) {
Â  Â  Â  Â  container.innerHTML = `<p style="text-align:center; color: var(--text-secondary); padding: 40px 0;">ChÆ°a cÃ³ ghi chÃº nÃ o.</p>`;
Â  Â  Â  Â  return;
Â  Â  }
Â  Â  container.innerHTML = notes.map(note => `
Â  Â  Â  Â  <div class="data-card" onclick="openNote('${note.id}')">
Â  Â  Â  Â  Â  Â  <div class="data-header">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="data-title">${note.title}</span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="data-subtitle">${new Date(note.date).toLocaleDateString('vi-VN')}</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="data-content">${note.content.substring(0, 100)}${note.content.length > 100 ? '...' : ''}</div>
Â  Â  Â  Â  Â  Â  <div class="data-actions">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="data-btn delete" onclick="event.stopPropagation(); deleteNote('${note.id}');">XÃ³a</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>`).join('');
}
function openNote(id = null) {
Â  Â  const titleInput = document.getElementById('noteTitle'), contentInput = document.getElementById('noteContent'), editIdInput = document.getElementById('editNoteId'), modalTitle = document.getElementById('noteModalTitle');
Â  Â  if (id) {
Â  Â  Â  Â  const note = DB.get('notes').find(n => n.id === id);
Â  Â  Â  Â  modalTitle.textContent = "Chá»‰nh sá»­a ghi chÃº";
Â  Â  Â  Â  titleInput.value = note.title;
Â  Â  Â  Â  contentInput.value = note.content;
Â  Â  Â  Â  editIdInput.value = id;
Â  Â  } else {
Â  Â  Â  Â  modalTitle.textContent = "Táº¡o ghi chÃº má»›i";
Â  Â  Â  Â  titleInput.value = ''; contentInput.value = ''; editIdInput.value = '';
Â  Â  }
Â  Â  openModal('noteModal');
}
function saveNote() {
Â  Â  const title = document.getElementById('noteTitle').value.trim();
Â  Â  if (!title) { alert('Vui lÃ²ng nháº­p tiÃªu Ä‘á».'); return; }
Â  Â  const editId = document.getElementById('editNoteId').value;
Â  Â  let notes = DB.get('notes');
Â  Â  if (editId) {
Â  Â  Â  Â  const noteIndex = notes.findIndex(n => n.id === editId);
Â  Â  Â  Â  if (noteIndex > -1) {
Â  Â  Â  Â  Â  Â  notes[noteIndex].title = title;
Â  Â  Â  Â  Â  Â  notes[noteIndex].content = document.getElementById('noteContent').value.trim();
Â  Â  Â  Â  Â  Â  notes[noteIndex].date = new Date().toISOString();
Â  Â  Â  Â  }
Â  Â  } else {
Â  Â  Â  Â  notes.unshift({ id: 'note_' + Date.now(), date: new Date().toISOString(), title, content: document.getElementById('noteContent').value.trim() });
Â  Â  }
Â  Â  DB.save('notes', notes);
Â  Â  closeModal('noteModal');
Â  Â  renderNotes();
}
function deleteNote(id) {
Â  Â  if (confirm('Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a ghi chÃº nÃ y?')) {
Â  Â  Â  Â  DB.save('notes', DB.get('notes').filter(n => n.id !== id));
Â  Â  Â  Â  renderNotes();
Â  Â  }
}

// --- Photos ---
async function renderPhotos() {
Â  Â  const container = document.getElementById('photosGrid');
Â  Â  try {
Â  Â  Â  Â  const photos = await IDB.getAll();
Â  Â  Â  Â  if (photos.length === 0) {
Â  Â  Â  Â  Â  Â  container.innerHTML = `<p style="text-align:center; color: var(--text-secondary); padding: 40px 0; grid-column: 1 / -1;">ChÆ°a cÃ³ áº£nh nÃ o Ä‘Æ°á»£c lÆ°u.</p>`;
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  Â  container.innerHTML = photos.map(photo => `
Â  Â  Â  Â  Â  Â  <div class="photo-item">
Â  Â  Â  Â  Â  Â  Â  Â  <img src="${photo.imageData}" alt="${photo.title}" loading="lazy">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="delete-photo-btn" onclick="deletePhoto('${photo.id}')">Ã—</button>
Â  Â  Â  Â  Â  Â  </div>`).join('');
Â  Â  } catch (e) {
Â  Â  Â  Â  console.error("Lá»—i khi táº£i áº£nh:", e);
Â  Â  Â  Â  container.innerHTML = `<p style="text-align:center; color: var(--accent-red); padding: 40px 0; grid-column: 1 / -1;">KhÃ´ng thá»ƒ táº£i áº£nh Ä‘Ã£ lÆ°u.</p>`;
Â  Â  }
}
function openPhotoModal() { openModal('photoModal'); }
function handlePhotoPreview(event) {
Â  Â  const file = event.target.files[0];
Â  Â  if (file) {
Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  reader.onload = e => {
Â  Â  Â  Â  Â  Â  const preview = document.getElementById('photoPreview');
Â  Â  Â  Â  Â  Â  preview.src = e.target.result;
Â  Â  Â  Â  Â  Â  preview.style.display = 'block';
Â  Â  Â  Â  }
Â  Â  Â  Â  reader.readAsDataURL(file);
Â  Â  }
}
async function savePhoto() {
Â  Â  const imageData = document.getElementById('photoPreview').src;
Â  Â  if (!imageData || imageData.startsWith('http')) { alert('Vui lÃ²ng chá»n má»™t áº£nh Ä‘á»ƒ lÆ°u.'); return; }
Â  Â  const photo = { id: 'photo_' + Date.now(), title: document.getElementById('photoTitle').value.trim() || "KhÃ´ng cÃ³ tiÃªu Ä‘á»", imageData };
Â  Â  try {
Â  Â  Â  Â  await IDB.add(photo);
Â  Â  Â  Â  closeModal('photoModal');
Â  Â  Â  Â  renderPhotos();
Â  Â  Â  Â  showToast('ÄÃ£ lÆ°u áº£nh thÃ nh cÃ´ng!');
Â  Â  } catch (e) {
Â  Â  Â  Â  showToast('Lá»—i khi lÆ°u áº£nh.');
Â  Â  }
}
async function deletePhoto(id) {
Â  Â  if (confirm('Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a áº£nh nÃ y?')) {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  await IDB.delete(id);
Â  Â  Â  Â  Â  Â  renderPhotos();
Â  Â  Â  Â  Â  Â  showToast('ÄÃ£ xÃ³a áº£nh.');
Â  Â  Â  Â  } catch(e) { showToast('Lá»—i khi xÃ³a áº£nh.'); }
Â  Â  }
}

// --- Passwords ---
function renderPasswords() {
Â  Â  const container = document.getElementById('passwordsList');
Â  Â  const passwords = DB.get('passwords');
Â  Â  if (passwords.length === 0) {
Â  Â  Â  Â  container.innerHTML = `<p style="text-align:center; color: var(--text-secondary); padding: 40px 0;">ChÆ°a cÃ³ máº­t kháº©u nÃ o Ä‘Æ°á»£c lÆ°u.</p>`;
Â  Â  Â  Â  return;
Â  Â  }
Â  Â  container.innerHTML = passwords.map(p => `
Â  Â  <div class="data-card">
Â  Â  Â  Â  <div class="data-header">
Â  Â  Â  Â  Â  Â  <span class="data-title">${p.service}</span>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="password-field-container">
Â  Â  Â  Â  Â  Â  <div class="password-label">TÃªn Ä‘Äƒng nháº­p</div>
Â  Â  Â  Â  Â  Â  <div class="password-value-container">${p.username || 'N/A'}</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="password-field-container">
Â  Â  Â  Â  Â  Â  <div class="password-label">Máº­t kháº©u</div>
Â  Â  Â  Â  Â  Â  <div class="password-value-container" id="pass-val-${p.id}">â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</div>
Â  Â  Â  Â  Â  Â  <div class="password-actions">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="password-btn" onclick="togglePasswordVisibility('${p.id}', this)">Xem</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="password-btn" onclick="copyToClipboard('${p.password}', 'máº­t kháº©u')">Sao chÃ©p</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="data-actions">
Â  Â  Â  Â  Â  Â  <button class="data-btn" onclick="openPasswordModal('${p.id}')">Sá»­a</button>
Â  Â  Â  Â  Â  Â  <button class="data-btn delete" onclick="deletePassword('${p.id}')">XÃ³a</button>
Â  Â  Â  Â  </div>
Â  Â  </div>`).join('');
}
function openPasswordModal(id = null) {
Â  Â  const modalTitle = document.getElementById('passwordModalTitle'), serviceInput = document.getElementById('passwordService'), usernameInput = document.getElementById('passwordUsername'), passwordInput = document.getElementById('passwordValue'), editIdInput = document.getElementById('editPasswordId');
Â  Â  if (id) {
Â  Â  Â  Â  const p = DB.get('passwords').find(item => item.id === id);
Â  Â  Â  Â  modalTitle.textContent = "Chá»‰nh sá»­a máº­t kháº©u";
Â  Â  Â  Â  serviceInput.value = p.service; usernameInput.value = p.username; passwordInput.value = p.password; editIdInput.value = id;
Â  Â  } else {
Â  Â  Â  Â  modalTitle.textContent = "ThÃªm máº­t kháº©u má»›i";
Â  Â  Â  Â  serviceInput.value = ''; usernameInput.value = ''; passwordInput.value = ''; editIdInput.value = '';
Â  Â  }
Â  Â  openModal('passwordModal');
}
function savePassword() {
Â  Â  const service = document.getElementById('passwordService').value.trim();
Â  Â  const password = document.getElementById('passwordValue').value;
Â  Â  if (!service || !password) { alert('Vui lÃ²ng nháº­p dá»‹ch vá»¥ vÃ  máº­t kháº©u.'); return; }
Â  Â Â 
Â  Â  let passwords = DB.get('passwords');
Â  Â  const editId = document.getElementById('editPasswordId').value;
Â  Â  const newEntry = {
Â  Â  Â  Â  service,
Â  Â  Â  Â  username: document.getElementById('passwordUsername').value.trim(),
Â  Â  Â  Â  password
Â  Â  };

Â  Â  if (editId) {
Â  Â  Â  Â  const index = passwords.findIndex(p => p.id === editId);
Â  Â  Â  Â  if (index > -1) passwords[index] = { ...passwords[index], ...newEntry };
Â  Â  } else {
Â  Â  Â  Â  passwords.unshift({ id: 'pass_' + Date.now(), ...newEntry });
Â  Â  }
Â  Â  DB.save('passwords', passwords);
Â  Â  closeModal('passwordModal');
Â  Â  renderPasswords();
}
function deletePassword(id) {
Â  Â  if (confirm('Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a máº­t kháº©u nÃ y?')) {
Â  Â  Â  Â  DB.save('passwords', DB.get('passwords').filter(p => p.id !== id));
Â  Â  Â  Â  renderPasswords();
Â  Â  }
}
function togglePasswordVisibility(id, button) {
Â  Â  const passField = document.getElementById(`pass-val-${id}`);
Â  Â  const password = DB.get('passwords').find(item => item.id === id)?.password;
Â  Â  if (!password) return;
Â  Â  if (passField.textContent === 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢') {
Â  Â  Â  Â  passField.textContent = password;
Â  Â  Â  Â  button.textContent = 'áº¨n';
Â  Â  } else {
Â  Â  Â  Â  passField.textContent = 'â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢';
Â  Â  Â  Â  button.textContent = 'Xem';
Â  Â  }
}
async function copyToClipboard(text, type) {
Â  Â  try {
Â  Â  Â  Â  await navigator.clipboard.writeText(text);
Â  Â  Â  Â  showToast(`ÄÃ£ sao chÃ©p ${type}!`);
Â  Â  } catch (err) {
Â  Â  Â  Â  showToast(`Lá»—i khi sao chÃ©p!`);
Â  Â  }
}

// --- Settings & General ---
async function resetData() {
Â  Â  if (confirm('Cáº¢NH BÃO: HÃ nh Ä‘á»™ng nÃ y sáº½ xÃ³a Táº¤T Cáº¢ dá»¯ liá»‡u. Báº¡n cÃ³ muá»‘n tiáº¿p tá»¥c?')) {
Â  Â  Â  Â  localStorage.clear();
Â  Â  Â  Â  sessionStorage.clear();
Â  Â  Â  Â  await IDB.clear();
Â  Â  Â  Â  alert('ÄÃ£ xÃ³a toÃ n bá»™ dá»¯ liá»‡u.');
Â  Â  Â  Â  window.location.reload();
Â  Â  }
}
function reloadApp() { window.location.reload(); }

// --- Music Player ---
const musicPlayer = {
Â  Â  playerReady: false,
Â  Â  expanded: false,
Â  Â  onPlayerReady(event) { this.playerReady = true; },
Â  Â  togglePlayPause(event) {
Â  Â  Â  Â  event.stopPropagation();
Â  Â  Â  Â  if (!this.playerReady) return;
Â  Â  Â  Â  const state = player.getPlayerState();
Â  Â  Â  Â  if (state === YT.PlayerState.PLAYING) player.pauseVideo();
Â  Â  Â  Â  else player.playVideo();
Â  Â  },
Â  Â  toggleExpand(event) {
Â  Â  Â  Â  event.stopPropagation();
Â  Â  Â  Â  const bubble = document.getElementById('music-player-bubble');
Â  Â  Â  Â  if (event.target !== bubble && !event.target.classList.contains('bubble-icon')) return;
Â  Â  Â  Â  this.expanded = !this.expanded;
Â  Â  Â  Â  bubble.classList.toggle('expanded', this.expanded);
Â  Â  Â  Â  if (!this.expanded && this.playerReady) player.pauseVideo();
Â  Â  }
};

// --- Passcode Protection ---
const passcode = {
Â  Â  PASSCODE_LENGTH: 4, currentInput: "", mode: 'verify', onSuccess: null,
Â  Â  elements: { screen: document.getElementById('passcode-screen'), title: document.getElementById('passcode-title'), dots: document.getElementById('passcode-dots').children, error: document.getElementById('passcode-error') },
Â  Â  reset() { this.currentInput = ""; this.updateDots(); this.elements.error.textContent = ""; },
Â  Â  updateDots() { for (let i = 0; i < this.PASSCODE_LENGTH; i++) this.elements.dots[i].classList.toggle('filled', i < this.currentInput.length); },
Â  Â  keyPress(key) {
Â  Â  Â  Â  if (this.currentInput.length >= this.PASSCODE_LENGTH) return;
Â  Â  Â  Â  this.currentInput += key;
Â  Â  Â  Â  this.updateDots();
Â  Â  Â  Â  if (this.currentInput.length === this.PASSCODE_LENGTH) setTimeout(() => this.handleSubmit(), 200);
Â  Â  },
Â  Â  backspace() { this.currentInput = this.currentInput.slice(0, -1); this.updateDots(); },
Â  Â  handleSubmit() { this.mode === 'verify' ? this.verify() : this.set(); },
Â  Â  show() { this.elements.screen.classList.add('show'); },
Â  Â  hide() { this.elements.screen.classList.remove('show'); },
Â  Â  prompt(onSuccess) { this.mode = 'verify'; this.onSuccess = onSuccess; this.reset(); this.elements.title.textContent = 'Nháº­p máº­t mÃ£'; this.show(); },
Â  Â  startSetup(onSuccess) { this.mode = 'set'; this.onSuccess = onSuccess; this.reset(); this.elements.title.textContent = 'Táº¡o máº­t mÃ£ má»›i'; this.show(); },
Â  Â  verify() {
Â  Â  Â  Â  if (this.currentInput === localStorage.getItem('masterPassword')) {
Â  Â  Â  Â  Â  Â  sessionStorage.setItem('isAuthenticated', 'true');
Â  Â  Â  Â  Â  Â  this.hide();
Â  Â  Â  Â  Â  Â  if (this.onSuccess) this.onSuccess();
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  this.elements.error.textContent = "Máº­t mÃ£ khÃ´ng Ä‘Ãºng.";
Â  Â  Â  Â  Â  Â  setTimeout(() => this.reset(), 1000);
Â  Â  Â  Â  }
Â  Â  },
Â  Â  set() {
Â  Â  Â  Â  const firstInput = this.currentInput;
Â  Â  Â  Â  this.reset();
Â  Â  Â  Â  this.elements.title.textContent = 'XÃ¡c nháº­n máº­t mÃ£';
Â  Â  Â  Â  this.handleSubmit = () => {
Â  Â  Â  Â  Â  Â  if (this.currentInput === firstInput) {
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('masterPassword', this.currentInput);
Â  Â  Â  Â  Â  Â  Â  Â  localStorage.setItem('passwordProtectionEnabled', 'true');
Â  Â  Â  Â  Â  Â  Â  Â  sessionStorage.setItem('isAuthenticated', 'true');
Â  Â  Â  Â  Â  Â  Â  Â  this.hide();
Â  Â  Â  Â  Â  Â  Â  Â  if (this.onSuccess) this.onSuccess();
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  this.elements.error.textContent = "Máº­t mÃ£ khÃ´ng khá»›p.";
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => this.startSetup(this.onSuccess), 1500);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  }
};

function togglePasswordProtection() {
Â  Â  const isEnabled = localStorage.getItem('passwordProtectionEnabled') === 'true';
Â  Â  const toggleElement = document.getElementById('password-protection-toggle');
Â  Â  if (isEnabled) {
Â  Â  Â  Â  passcode.prompt(() => {
Â  Â  Â  Â  Â  Â  localStorage.setItem('passwordProtectionEnabled', 'false');
Â  Â  Â  Â  Â  Â  sessionStorage.removeItem('isAuthenticated');
Â  Â  Â  Â  Â  Â  toggleElement.classList.remove('active');
Â  Â  Â  Â  Â  Â  showToast('ÄÃ£ táº¯t khÃ³a á»©ng dá»¥ng.');
Â  Â  Â  Â  });
Â  Â  } else {
Â  Â  Â  Â  passcode.startSetup(() => {
Â  Â  Â  Â  Â  Â  toggleElement.classList.add('active');
Â  Â  Â  Â  Â  Â  showToast('ÄÃ£ báº­t khÃ³a á»©ng dá»¥ng.');
Â  Â  Â  Â  });
Â  Â  }
}

// =================================================================
// 5. APP BOOTSTRAP
// =================================================================
function renderAllScreens() {
Â  Â  renderStats();
Â  Â  renderHistory();
Â  Â  renderNotes();
Â  Â  renderPasswords();
Â  Â  renderPhotos();
}

document.addEventListener('DOMContentLoaded', () => {
Â  Â  if (!clockInterval) {
Â  Â  Â  Â  updateClockAndSchedule();
Â  Â  Â  Â  clockInterval = setInterval(updateClockAndSchedule, 1000);
Â  Â  }
Â  Â  renderAllScreens();
});
</script>
</body>
</html>
sá»­a dÃ¹m tÃ´i cÃ¡i áº¥n nghe nháº¡c áº¥y ko cs cÃ¡i táº¯t nháº¡c kiá»ƒu Ä‘Ã³ng tab nháº¡c áº¥y vá»›i bá» cÃ¡i má»¥c áº£nh Ä‘i lÃ m ná»n web kiá»ƒu cÃ³ tÃ­ hiá»‡u á»©ng nhr di chuyá»ƒn cháº­m cháº­m cho chill chill 
